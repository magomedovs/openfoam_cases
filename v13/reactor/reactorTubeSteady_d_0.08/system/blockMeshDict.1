/*--------------------------------*- C++ -*----------------------------------*\
  =========                 |
  \\      /  F ield         | OpenFOAM: The Open Source CFD Toolbox
   \\    /   O peration     | Website:  https://openfoam.org
    \\  /    A nd           | Version:  12
     \\/     M anipulation  |
\*---------------------------------------------------------------------------*/
FoamFile
{
    format      ascii;
    class       dictionary;
    object      blockMeshDict;
}
// * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * //

// block definition for a round tube along z-axis (O-grid topology).

// inletNozzle -> middleTube -> outletNozzle -> outletTube

inletNozzleLength           0.04;   // [m]
middleTubeLength            0.7; //0.66;     // length [m]
outletNozzleLength          $inletNozzleLength; //0.04;   // [m]
outletTubeLength            0.26;   // [m]

inletNozzleRadius           0.01;   // [m]
middleTubeRadius            0.0252;   // radius [m]
outletTubeRadius            $inletNozzleRadius; //0.01;   // [m]

convertToMeters           1.;

spatialStep     0.004;

xyCells                 #calc "ceil(2 * $middleTubeRadius / $spatialStep)";
xCells                  #calc "ceil($xyCells / 3)"; //4;
yCells                  #calc "ceil(1.5 * $xCells)"; //4;

inletNozzleZcells       #calc "ceil($inletNozzleLength / $spatialStep)"; //8;
middleTubeZCells        #calc "ceil($middleTubeLength / $spatialStep)"; //100;
outletNozzleZcells      #calc "ceil($outletNozzleLength / $spatialStep)"; //8;
outletTubeZcells        #calc "ceil($outletTubeLength / $spatialStep)"; //52; 

xCellsMid $xCells;
yCellsMid $xCells;
zcellsMid $middleTubeZCells;

stretch 1.;     //0.25;

middleTubeRadius_1      #calc "$middleTubeRadius * 0.25";
middleTubeRadius_2      #calc "$middleTubeRadius * 0.707106";

mMiddleTubeRadius       #calc "-$middleTubeRadius";
mMiddleTubeRadius_1     #calc "-$middleTubeRadius * 0.25";
mMiddleTubeRadius_2     #calc "-$middleTubeRadius * 0.707106";

inletNozzleRadius_1     #calc "$inletNozzleRadius * 0.25";
inletNozzleRadius_2     #calc "$inletNozzleRadius * 0.707106";

minletNozzleRadius      #calc "-$inletNozzleRadius";
minletNozzleRadius_1    #calc "-$inletNozzleRadius * 0.25";
minletNozzleRadius_2    #calc "-$inletNozzleRadius * 0.707106";

outletTubeRadius_1      #calc "$outletTubeRadius * 0.25";
outletTubeRadius_2      #calc "$outletTubeRadius * 0.707106";

mOutletTubeRadius       #calc "-$outletTubeRadius";
mOutletTubeRadius_1     #calc "-$outletTubeRadius * 0.25";
mOutletTubeRadius_2     #calc "-$outletTubeRadius * 0.707106";

inletNozzleStartZCoord  #calc "-$inletNozzleLength";

middleTubeStartZCoord   #calc "$inletNozzleStartZCoord + $inletNozzleLength";
middleTubeEndZCoord     #calc "$middleTubeStartZCoord + $middleTubeLength";
outletNozzleEndZCoord   #calc "$middleTubeEndZCoord + $outletNozzleLength";
outletTubeEndZCoord     #calc "$outletNozzleEndZCoord + $outletTubeLength";

vertices
(
    //block0 vertices (top)
    ($mMiddleTubeRadius_1 $middleTubeRadius_1 $middleTubeStartZCoord) //0
    ($mMiddleTubeRadius_2 $middleTubeRadius_2 $middleTubeStartZCoord) //1
    ($middleTubeRadius_2 $middleTubeRadius_2 $middleTubeStartZCoord) //2
    ($middleTubeRadius_1 $middleTubeRadius_1 $middleTubeStartZCoord) //3
    ($mMiddleTubeRadius_1 $middleTubeRadius_1 $middleTubeEndZCoord) //4
    ($mMiddleTubeRadius_2 $middleTubeRadius_2 $middleTubeEndZCoord) //5
    ($middleTubeRadius_2 $middleTubeRadius_2 $middleTubeEndZCoord) //6
    ($middleTubeRadius_1 $middleTubeRadius_1 $middleTubeEndZCoord) //7

    //block1 new vertices (right)
    ($middleTubeRadius_1 $mMiddleTubeRadius_1 $middleTubeStartZCoord) //8
    ($middleTubeRadius_2 $mMiddleTubeRadius_2 $middleTubeStartZCoord) //9
    ($middleTubeRadius_1 $mMiddleTubeRadius_1 $middleTubeEndZCoord) //10
    ($middleTubeRadius_2 $mMiddleTubeRadius_2 $middleTubeEndZCoord) //11

    //block3 new vertices (left)
    ($mMiddleTubeRadius_1 $mMiddleTubeRadius_1 $middleTubeStartZCoord) //12
    ($mMiddleTubeRadius_2 $mMiddleTubeRadius_2 $middleTubeStartZCoord) //13
    ($mMiddleTubeRadius_1 $mMiddleTubeRadius_1 $middleTubeEndZCoord) //14
    ($mMiddleTubeRadius_2 $mMiddleTubeRadius_2 $middleTubeEndZCoord) //15

// inletNozzleBlock    
    //inletNozzleBlock0 vertices (top)
    ($minletNozzleRadius_1 $inletNozzleRadius_1 $inletNozzleStartZCoord) //16
    ($minletNozzleRadius_2 $inletNozzleRadius_2 $inletNozzleStartZCoord) //17
    ($inletNozzleRadius_2 $inletNozzleRadius_2 $inletNozzleStartZCoord) //18
    ($inletNozzleRadius_1 $inletNozzleRadius_1 $inletNozzleStartZCoord) //19

    //inletNozzleBlock1 new vertices (right)
    ($inletNozzleRadius_1 $minletNozzleRadius_1 $inletNozzleStartZCoord) //20
    ($inletNozzleRadius_2 $minletNozzleRadius_2 $inletNozzleStartZCoord) //21

    //inletNozzleBlock3 new vertices (left)
    ($minletNozzleRadius_1 $minletNozzleRadius_1 $inletNozzleStartZCoord) //22
    ($minletNozzleRadius_2 $minletNozzleRadius_2 $inletNozzleStartZCoord) //23

// outletNozzleBlock    
    //outletNozzleBlock0 vertices (top)
    ($mOutletTubeRadius_1 $outletTubeRadius_1 $outletNozzleEndZCoord) //24
    ($mOutletTubeRadius_2 $outletTubeRadius_2 $outletNozzleEndZCoord) //25
    ($outletTubeRadius_2 $outletTubeRadius_2 $outletNozzleEndZCoord) //26
    ($outletTubeRadius_1 $outletTubeRadius_1 $outletNozzleEndZCoord) //27

    //outletNozzleBlock1 new vertices (right)
    ($outletTubeRadius_1 $mOutletTubeRadius_1 $outletNozzleEndZCoord) //28
    ($outletTubeRadius_2 $mOutletTubeRadius_2 $outletNozzleEndZCoord) //29

    //outletNozzleBlock3 new vertices (left)
    ($mOutletTubeRadius_1 $mOutletTubeRadius_1 $outletNozzleEndZCoord) //30
    ($mOutletTubeRadius_2 $mOutletTubeRadius_2 $outletNozzleEndZCoord) //31

// outletTubeBlock    
    //outletTubeBlock0 vertices (top)
    ($mOutletTubeRadius_1 $outletTubeRadius_1 $outletTubeEndZCoord) //32
    ($mOutletTubeRadius_2 $outletTubeRadius_2 $outletTubeEndZCoord) //33
    ($outletTubeRadius_2 $outletTubeRadius_2 $outletTubeEndZCoord) //34
    ($outletTubeRadius_1 $outletTubeRadius_1 $outletTubeEndZCoord) //35

    //outletTubeBlock1 new vertices (right)
    ($outletTubeRadius_1 $mOutletTubeRadius_1 $outletTubeEndZCoord) //36
    ($outletTubeRadius_2 $mOutletTubeRadius_2 $outletTubeEndZCoord) //37

    //outletTubeBlock3 new vertices (left)
    ($mOutletTubeRadius_2 $mOutletTubeRadius_2 $outletTubeEndZCoord) //38
    ($mOutletTubeRadius_1 $mOutletTubeRadius_1 $outletTubeEndZCoord) //39
);

blocks
(
    //block0    (top)
    hex (0 3 2 1 4 7 6 5) ($xCells $yCells $middleTubeZCells) simpleGrading (1 $stretch 1)
    //block1    (right)
    hex (3 8 9 2 7 10 11 6) ($xCells $yCells $middleTubeZCells) simpleGrading (1 $stretch 1)
    //block2    (bottom)
    hex (8 12 13 9 10 14 15 11) ($xCells $yCells $middleTubeZCells) simpleGrading (1 $stretch 1)
    //block3    (left)
    hex (12 0 1 13 14 4 5 15) ($xCells $yCells $middleTubeZCells) simpleGrading (1 $stretch 1)
    //block4    (middle)
    hex (0 12 8 3 4 14 10 7) ($xCellsMid $yCellsMid $zcellsMid) simpleGrading (1 1 1)

// inletNozzleBlock
    //block0    (top)
    hex (16 19 18 17 0 3 2 1) ($xCells $yCells $inletNozzleZcells) simpleGrading (1 $stretch 1)
    //block1    (right)
    hex (19 20 21 18 3 8 9 2) ($xCells $yCells $inletNozzleZcells) simpleGrading (1 $stretch 1)
    //block2    (bottom)
    hex (20 22 23 21 8 12 13 9) ($xCells $yCells $inletNozzleZcells) simpleGrading (1 $stretch 1)
    //block3    (left)
    hex (22 16 17 23 12 0 1 13) ($xCells $yCells $inletNozzleZcells) simpleGrading (1 $stretch 1)
    //block4    (middle)
    hex (16 22 20 19 0 12 8 3) ($xCellsMid $yCellsMid $inletNozzleZcells) simpleGrading (1 1 1)

// outletNozzleBlock
    //block0    (top)
    hex (4 7 6 5 24 27 26 25) ($xCells $yCells $outletNozzleZcells) simpleGrading (1 $stretch 1)
    //block1    (right)
    hex (7 10 11 6 27 28 29 26) ($xCells $yCells $outletNozzleZcells) simpleGrading (1 $stretch 1)
    //block2    (bottom)
    hex (10 14 15 11 28 30 31 29) ($xCells $yCells $outletNozzleZcells) simpleGrading (1 $stretch 1)
    //block3    (left)
    hex (14 4 5 15 30 24 25 31) ($xCells $yCells $outletNozzleZcells) simpleGrading (1 $stretch 1)
    //block4    (middle)
    hex (4 14 10 7 24 30 28 27) ($xCellsMid $yCellsMid $outletNozzleZcells) simpleGrading (1 1 1)

// outletTubeBlock
    //block0    (top)
    hex (24 27 26 25 32 35 34 33) ($xCells $yCells $outletTubeZcells) simpleGrading (1 $stretch 1)
    //block1    (right)
    hex (27 28 29 26 35 36 37 34) ($xCells $yCells $outletTubeZcells) simpleGrading (1 $stretch 1)
    //block2    (bottom)
    hex (28 30 31 29 36 39 38 37) ($xCells $yCells $outletTubeZcells) simpleGrading (1 $stretch 1)
    //block3    (left)
    hex (30 24 25 31 39 32 33 38) ($xCells $yCells $outletTubeZcells) simpleGrading (1 $stretch 1)
    //block4    (middle)
    hex (24 30 28 27 32 39 36 35) ($xCellsMid $yCellsMid $outletTubeZcells) simpleGrading (1 1 1)
);

edges
(
    //block0 arc
    arc 1 2 (0 $middleTubeRadius $middleTubeStartZCoord)
    arc 5 6 (0 $middleTubeRadius $middleTubeEndZCoord)
    //block1 arc
    arc 2 9 ($middleTubeRadius 0 $middleTubeStartZCoord)
    arc 6 11 ($middleTubeRadius 0 $middleTubeEndZCoord)
    //block2 arc
    arc 9 13 (0 $mMiddleTubeRadius $middleTubeStartZCoord)
    arc 11 15 (0 $mMiddleTubeRadius $middleTubeEndZCoord)
    //block3 arc
    arc 1 13 ($mMiddleTubeRadius 0 $middleTubeStartZCoord)
    arc 5 15 ($mMiddleTubeRadius 0 $middleTubeEndZCoord)

// inletNozzleBlock
    //block0 arc
    arc 17 18 (0 $inletNozzleRadius $inletNozzleStartZCoord)
    //block1 arc
    arc 18 21 ($inletNozzleRadius 0 $inletNozzleStartZCoord)
    //block2 arc
    arc 21 23 (0 $minletNozzleRadius $inletNozzleStartZCoord)
    //block3 arc
    arc 17 23 ($minletNozzleRadius 0 $inletNozzleStartZCoord)

// outletNozzleBlock
    //block0 arc
    arc 25 26 (0 $outletTubeRadius $outletNozzleEndZCoord)
    //block1 arc
    arc 26 29 ($outletTubeRadius 0 $outletNozzleEndZCoord)
    //block2 arc
    arc 29 31 (0 $mOutletTubeRadius $outletNozzleEndZCoord)
    //block3 arc
    arc 25 31 ($mOutletTubeRadius 0 $outletNozzleEndZCoord)

// outletTubeBlock
    //block0 arc
    arc 33 34 (0 $outletTubeRadius $outletTubeEndZCoord)
    //block1 arc
    arc 34 37 ($outletTubeRadius 0 $outletTubeEndZCoord)
    //block2 arc
    arc 37 38 (0 $mOutletTubeRadius $outletTubeEndZCoord)
    //block3 arc
    arc 33 38 ($mOutletTubeRadius 0 $outletTubeEndZCoord)
);

boundary
(
    inlet
    {
        type patch;
        faces
        (
            (16 17 18 19)
            (21 20 19 18)
            (20 21 23 22)
            (17 16 22 23)
            (16 19 20 22)
        );
    }

    outlet
    {
        type patch;
        faces
        (
            (35 34 33 32)
            (34 35 36 37)
            (38 37 36 39)
            (38 39 32 33)
            (39 36 35 32)
        );
    }

    sideWalls
    {
        type wall;
        faces
        (
            (1 5 6 2)
            (2 6 11 9)
            (9 11 15 13)
            (15 5 1 13)

            //inletNozzleBlock boundary
            (17 1 2 18)
            (18 2 9 21)
            (21 9 13 23)
            (13 1 17 23)

            //outletNozzleBlock boundary
            (6 5 25 26)
            (6 26 29 11)
            (11 29 31 15)
            (15 31 25 5)

            //outletTubeBlock boundary
            (29 26 34 37)
            (26 25 33 34)
            (25 31 38 33)
            (29 31 38 37)
        );
    }
);

mergePatchPairs
(
);

// ************************************************************************* //
